var Debounce=(fn,t)=>{const delay=t||25;let timer;return function(){const args=arguments;if(timer){clearTimeout(timer)}timer=setTimeout(()=>{timer=null;fn.apply(this,args)},delay)}};(function($){volantis.$.bodyAnchor=$('#safearea');volantis.$.topBtn=$('#s-top');volantis.$.wrapper=$('#wrapper');volantis.$.postsBtn=$('.menu .active','#l_header,#l_cover');volantis.$.titleBtn=$('h1.title','#header-meta');volantis.$.coverAnchor=$('#l_cover .cover-wrapper');volantis.$.switcher=$('#l_header .switcher .s-search');volantis.$.header=$('#l_header');volantis.$.search=$('#l_header .m_search');volantis.$.mPhoneList=$('#l_header .m-phone .list-v');function setIsMobile(){if(document.documentElement.clientWidth<500){volantis.isMobile=1;volantis.isMobileOld=1}else{volantis.isMobile=0;volantis.isMobileOld=0}}var scrollCorrection=80;if(volantis.$.header[0]){scrollCorrection=volantis.$.header[0].clientHeight+16}function restData(){scrollCorrection=80;if(volantis.$.header[0]){scrollCorrection=volantis.$.header[0].clientHeight+16}}function scrolltoElement(elem,correction=scrollCorrection){const $elem=elem.href?$(decodeURI(elem.getAttribute('href'))):$(elem);window.scrollTo({top:$elem.offset().top-correction,behavior:'smooth'})}function setScrollAnchor(){if(volantis.$.postsBtn.length&&volantis.$.bodyAnchor){volantis.$.postsBtn.click(e=>{e.preventDefault();e.stopPropagation();if(volantis.$.postsBtn.attr('href')!='/'){scrolltoElement(volantis.$.bodyAnchor)}e.stopImmediatePropagation();volantis.$.postsBtn.unbind('click')})}if(volantis.$.titleBtn.length&&volantis.$.bodyAnchor){volantis.$.titleBtn.click(e=>{e.preventDefault();e.stopPropagation();scrolltoElement(volantis.$.bodyAnchor);e.stopImmediatePropagation();volantis.$.titleBtn.unbind('click')})}if(volantis.$.topBtn.length&&volantis.$.bodyAnchor){volantis.$.topBtn.click(e=>{e.preventDefault();e.stopPropagation();scrolltoElement(volantis.$.bodyAnchor);e.stopImmediatePropagation()})}var showHeaderPoint=volantis.$.bodyAnchor.offset().top-scrollCorrection;var pos=document.body.scrollTop;$(document,window).scroll(Debounce(()=>{const scrollTop=$(window).scrollTop();const del=scrollTop-pos;pos=scrollTop;if(scrollTop>volantis.$.bodyAnchor.offset().top){volantis.$.topBtn.addClass('show');if(del>0){volantis.$.topBtn.removeClass('hl')}else{volantis.$.topBtn.addClass('hl')}}else{volantis.$.topBtn.removeClass('show').removeClass('hl')}if(scrollTop-showHeaderPoint>-1){volantis.$.header.addClass('show')}else{volantis.$.header.removeClass('show')}}))}function setHeader(){if(!pdata.ispage)return;volantis.$.comment=$('#s-comment');volantis.$.toc=$('#s-toc');volantis.$.commentTarget=$('#l_body article#comments');volantis.$.wrapper.find('.nav-sub .title').html(pdata.postTitle);let pos=document.body.scrollTop;$(document,window).scroll(Debounce(()=>{const scrollTop=$(window).scrollTop();const del=scrollTop-pos;if(del>=50&&scrollTop>100){pos=scrollTop;volantis.$.wrapper.addClass('sub')}else if(del<=-50){pos=scrollTop;volantis.$.wrapper.removeClass('sub')}}));if(volantis.$.commentTarget.length){volantis.$.comment.click(e=>{e.preventDefault();e.stopPropagation();scrolltoElement(volantis.$.commentTarget);e.stopImmediatePropagation()})}else volantis.$.comment.remove();volantis.$.tocTarget=$('#l_body .toc-wrapper');if(volantis.$.tocTarget.length&&volantis.$.tocTarget.children().length){volantis.$.toc.click((e)=>{e.stopPropagation();volantis.$.tocTarget.toggleClass('active');volantis.$.toc.toggleClass('active')});$(document).click(function(e){e.stopPropagation();volantis.$.tocTarget.removeClass('active');volantis.$.toc.removeClass('active')});$(document,window).scroll(Debounce(()=>{volantis.$.tocTarget.removeClass('active');volantis.$.toc.removeClass('active')},100))}else volantis.$.toc.remove()}function setHeaderMenuSelection(){volantis.$.headerMenu=$('.navigation','#l_header,#l_cover,#l_side');volantis.$.headerMenu.find('li a.active').removeClass('active');volantis.$.headerMenu.find('div a.active').removeClass('active');function setUnderline($item){if($item&&$item.length){$item.addClass('active').siblings().removeClass('active')}}var $active_link=null;var idname=location.pathname.replace(/\/|%|\./g,'');if(idname.length==0){idname='home'}var page=idname.match(/page\d{0,}$/g);if(page){page=page[0];idname=idname.split(page)[0]}var index=idname.match(/index.html/);if(index){index=index[0];idname=idname.split(index)[0]}idname=idname.replace(/(\[|\]|~|#|@)/g,'\\$1');if(idname&&volantis.$.headerMenu){$active_link=$('#'+idname,volantis.$.headerMenu);setUnderline($active_link)}}function setGlobalHeaderMenuEvent(){if(volantis.isMobile){$('#l_header .m-phone li:has(.list-v)').click(function(e){e.stopPropagation();$($(e.currentTarget).children('ul')).show()})}else{$('#wrapper .m-pc li > a[href]').parent().click(function(e){e.stopPropagation();if(e.target.origin==e.target.baseURI){$('#wrapper .m-pc .list-v').hide()}})}setPageHeaderMenuEvent()}function setPageHeaderMenuEvent(){if(!volantis.isMobile)return $(document).click(function(e){volantis.$.mPhoneList.hide()});$(window).scroll(Debounce(()=>{volantis.$.mPhoneList.hide()}))}function setHeaderSearch(){if(volantis.$.switcher.length===0)return;volantis.$.switcher.click(function(e){e.stopPropagation();volantis.$.header.toggleClass('z_search-open');volantis.$.switcher.toggleClass('active');volantis.$.search.find('input').focus()});$(document).click(function(e){volantis.$.header.removeClass('z_search-open');volantis.$.switcher.removeClass('active')});volantis.$.search.click(function(e){e.stopPropagation()});volantis.$.header.ready(function(){volantis.$.header.bind('keydown',function(event){if(event.keyCode==9){return false}var isie=!!document.all;var key,ev;if(isie){key=window.event.keyCode;ev=window.event}else{key=event.which;ev=event}if(key==9){if(isie){ev.keyCode=0;ev.returnValue=false}else{ev.which=0;ev.preventDefault()}}})})}function setTabs(){if(!$('#l_main .tabs .nav-tabs').length)return $('#l_main .tabs .nav-tabs').on('click','a',(e)=>{e.preventDefault();e.stopPropagation();const $tab=$(e.target.parentElement.parentElement.parentElement);$tab.find('.nav-tabs .active').removeClass('active');$tab.find(e.target.parentElement).addClass('active');$tab.find('.tab-content .active').removeClass('active');$tab.find($(e.target).attr('class')).addClass('active');return false})}$(function(){setIsMobile()setHeader();setHeaderMenuSelection();setGlobalHeaderMenuEvent();setHeaderSearch();setScrollAnchor();setTabs();window.onresize=()=>{if(document.documentElement.clientWidth<500){volantis.isMobile=1}else{volantis.isMobile=0}if(volantis.isMobile!=volantis.isMobileOld){setGlobalHeaderMenuEvent()}}$('#scroll-down').on('click',function(){scrolltoElement(volantis.$.bodyAnchor)});volantis.pjax.push(()=>{$(function(){$('#l_header .nav-main').find('.list-v').not('.menu-phone').removeAttr("style","");$('#l_header .menu-phone.list-v').removeAttr("style","");restData();setHeader();setHeaderMenuSelection();setPageHeaderMenuEvent();setScrollAnchor();setTabs();$('#scroll-down').on('click',function(){scrolltoElement(volantis.$.bodyAnchor)});if(volantis.$.switcher.length!==0){$(document).click(function(e){volantis.$.header.removeClass('z_search-open');volantis.$.switcher.removeClass('active')})}})},'app.js');volantis.pjax.send(()=>{volantis.$.switcher.removeClass('active');volantis.$.header.removeClass('z_search-open');volantis.$.wrapper.removeClass('sub');volantis.$.topBtn.unbind('click');$('.menu a','#l_header,#l_cover').unbind('click');$(window).unbind('resize');$(window).unbind('scroll');$(document).unbind('scroll');$(document).unbind('click');$('body').unbind('click')},'app.js')});if(window.location.hash){var checkExist=setInterval(function(){if($('#'+decodeURI(window.location.hash.split('#')[1]).replace(/\ /g,'-')).length){$('html, body').animate({scrollTop:$('#'+decodeURI(window.location.hash.split('#')[1]).replace(/\ /g,'-')).offset().top-40},500);clearInterval(checkExist)}},100)}})(jQuery);